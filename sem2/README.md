# Студентка группы М8О-408Б-21 Суляева Алина Игоревна
Лабораторные работы 6-8 по курсу "Методы, средства и технологии мультимедиа"

Для выполнения данной лабораторной работы был выбран датасет Blood Cell Count and Detection.
BCCD Dataset — это небольшой, но широко используемый датасет для задач обнаружения и классификации клеток крови. Он содержит 364 микроскопических изображения с аннотациями в формате PASCAL VOC, охватывающими три класса:
- RBC (эритроциты)
- WBC (лейкоциты)
- Platelets (тромбоциты)

BCCD используется в исследованиях, направленных на автоматизацию анализа крови, что критично для диагностики заболеваний, таких как лейкемия. Традиционные методы анализа крови требуют ручной работы специалистов, что может быть трудоемким и подверженным ошибкам. Автоматизация этого процесса с помощью компьютерного зрения и глубокого обучения позволяет:
- Снизить нагрузку на медицинский персонал
- Увеличить точность и скорость диагностики
- Обеспечить объективность результатов

 ![example](https://github.com/user-attachments/assets/298c4387-0b16-4822-906a-c872fc854744)

### Структура `BCCD_dataset`

  ```
  ├── BCCD
  │   ├── Annotations
  │   │       └── BloodImage_00XYZ.xml (364 items)
  │   ├── ImageSets       # Contain four Main/*.txt which split the dataset
  │   └── JPEGImages
  │       └── BloodImage_00XYZ.jpg (364 items)
  ├── dataset
  │   └── mxnet           # Some preprocess scripts for mxnet
  ├── scripts
  │   ├── split.py        # A script to generate four .txt in ImageSets
  │   └── visualize.py    # A script to generate labeled img like example.jpg
  ├── example.jpg         # A example labeled img generated by visualize.py
  ├── LICENSE
  └── README.md
  ```

  `JPEGImages`:

  * **Image Type** : *jpeg(JPEG)*
  * **Width** x **Height** : *640 x 480*

Аннотации в формате VOC (.xml) для задачи обнаружения объектов, автоматически сгенерированные с помощью инструмента разметки. Ниже приведён пример файла .xml.

  ```xml
  <annotation>
  	<folder>JPEGImages</folder>
  	<filename>BloodImage_00000.jpg</filename>
  	<path>/home/pi/detection_dataset/JPEGImages/BloodImage_00000.jpg</path>
  	<source>
  		<database>Unknown</database>
  	</source>
  	<size>
  		<width>640</width>
  		<height>480</height>
  		<depth>3</depth>
  	</size>
  	<segmented>0</segmented>
  	<object>
  		<name>WBC</name>
  		<pose>Unspecified</pose>
  		<truncated>0</truncated>
  		<difficult>0</difficult>
  		<bndbox>
  			<xmin>260</xmin>
  			<ymin>177</ymin>
  			<xmax>491</xmax>
  			<ymax>376</ymax>
  		</bndbox>
  	</object>
      ...
  	<object>
  		...
  	</object>
  </annotation>
  ```

### Сводная таблица по всем моделям


| Метрика      | Бейзлайн (ResNet18) | Улучшенный бейзлайн (ResNet18) | Собственная имплементация |
| ------------ | ------------------- | ------------------------------ | ------------------------- |
| **Loss**     | **0.0114**          | 0.1089                         | 0.0150                         |
| **Accuracy** | **100.00%**         | 99.49%                         | 0.9990                     |
| **F1-score** | **1.0000**          | 0.9835                         | 0.9955                         |

 Сравнение моделей сегментации

| Метрика        | UNet (Base) | DeepLabV3+ (Base) | CustomUNet (Имплементация) |
| -------------- | ----------- | ----------------- | -------------------------- |
| **IoU**        | 0.3403      | 0.3352            | **0.4025**                 |
| **Dice**       | 0.4974      | 0.4897            | **0.5633**                 |
| **Train Loss** | 0.6749      | **0.6359**        | 0.9843                     |
| **Val Loss**   | 1.1291      | **0.7369**        | 1.0129                     |

 Обнаружение объектов (YOLO)

 Метрики по классам

| Класс         | Precision | Recall    | F1-score  | mAP\@0.5  |
| ------------- | --------- | --------- | --------- | --------- |
| **WBC**       | 0.804     | **0.986** | **0.981** | **0.767** |
| **RBC**       | 0.624     | **0.914** | **0.817** | 0.541     |
| **Platelets** | **0.868** | 0.440     | 0.738     | 0.342     |

 Сравнение реализаций YOLO по классам

 WBC (лейкоциты)

| Модель        | Precision | Recall    | F1-score  | mAP\@0.5  |
| ------------- | --------- | --------- | --------- | --------- |
| Бейзлайн      | 0.968     | 1.000     | 0.984     | **0.994** |
| Улучшенная    | **0.979** | 1.000     | **0.994** | 0.802     |
| Имплементация | 0.804     | **0.986** | 0.981     | 0.767     |

 RBC (эритроциты)

| Модель        | Precision | Recall    | F1-score  | mAP\@0.5  |
| ------------- | --------- | --------- | --------- | --------- |
| Бейзлайн      | **0.727** | 0.845     | 0.781     | **0.853** |
| Улучшенная    | 0.673     | 0.865     | 0.791     | 0.513     |
| Имплементация | 0.624     | **0.914** | **0.817** | 0.541     |

 Platelets (тромбоциты)

| Модель        | Precision | Recall    | F1-score  | mAP\@0.5  |
| ------------- | --------- | --------- | --------- | --------- |
| Бейзлайн      | 0.874     | **0.834** | **0.854** | **0.895** |
| Улучшенная    | **1.000** | 0.000     | 0.366     | 0.200     |
| Имплементация | 0.868     | 0.440     | 0.738     | 0.342     |


###  Вывод

* **Классификация**: Базовые модели (ResNet18 и ViT) показали максимальный F1, но улучшенные — более устойчивые и менее склонны к переобучению.
* **Детекция**: Улучшенный бейзлайн превосходит по WBC, но проваливается по Platelets. Имплементация даёт лучший F1 по RBC.
* **Сегментация**: CustomUNet — лидер по IoU и Dice, несмотря на более высокие потери.


### Как запустить проект

1. Установите все зависимости. Создайте виртуальное окружение и активируйте его (по желанию):

```bash
python -m venv venv
source venv/bin/activate  # или venv\Scripts\activate на Windows
```

2. Установите зависимости:

```bash
pip install torch torchvision torchaudio
pip install pandas numpy opencv-python matplotlib seaborn
pip install scikit-learn albumentations segmentation-models-pytorch
pip install ultralytics
```

3. Запустите нужный `.ipynb` файл в Jupyter Notebook или любой другой среде, поддерживающей Jupyter (например, VS Code, Google Colab).

4. Для запуска:

```bash
jupyter notebook
```

Или откройте файл в VS Code.
